# Cross-Language Compatibility Status

## Summary

Both implementations now interoperate for lifetimes `2^8` and `2^18` with 256 active epochs. Keys and signatures generated by one implementation verify cleanly in the other when the helpers share the same seed and lifetime parameters.

## How we test

`python3 benchmark/benchmark.py` (also run in CI) performs the following for each lifetime:

1. Build the helper binaries (`zig-remote-hash-tool`, `remote_hashsig_tool`)
2. Generate deterministic keys using `SEED_HEX=4242…4242`
3. Sign a message with Zig and Rust helpers
4. Verify the resulting signatures with both implementations
5. Record timings and drop artefacts under `/tmp`

### Sample summary output

```
Lifetime 2^18 (lifetime 2^18):
  Rust sign (keygen)             PASS  (0.028s)
  Rust sign → Rust verify        PASS  (0.004s)
  Rust sign → Zig verify         PASS  (0.037s)
  Zig sign (keygen)              PASS  (6.847s)
  Zig sign → Zig verify          PASS  (0.039s)
  Zig sign → Rust verify         PASS  (0.007s)
```

`VERIFY_RESULT:true` must appear in all four verification steps for the run to be considered successful.

## Manual reproduction

To replay a single direction without the driver script:

```bash
# Build helpers once
zig build zig-remote-hash-tool -Doptimize=ReleaseFast
cargo build --manifest-path benchmark/rust_benchmark/Cargo.toml --release --bin remote_hashsig_tool

# Rust sign, Zig verify (lifetime 2^18 shown)
benchmark/rust_benchmark/target/release/remote_hashsig_tool \
  sign "interop test" /tmp/rust_public.key.json /tmp/rust_signature.bin \
  4242…4242 0 256 0 2^18

zig-out/bin/zig-remote-hash-tool verify "interop test" \
  /tmp/rust_public.key.json /tmp/rust_signature.bin 0 2^18
```

Swap the commands to exercise Zig→Rust. The helpers accept lifetime values `2^8` or `2^18`; extend them if you add more scenarios.

## Artefacts

The script writes the most recent public keys and signatures to `/tmp` using the following pattern:

- `/tmp/rust_public_2pow8.key.json`
- `/tmp/rust_signature_2pow8.bin`
- `/tmp/zig_public_2pow8.key.json`
- `/tmp/zig_signature_2pow8.bin`

(and the `2pow18` counterparts).

## Expectations going forward

- Continue to run the script (or the CI job) whenever cross-language compatibility changes.
- If you change serialization formats or helper behavior, add a new scenario to `benchmark.py` and update this document with the new expectations.
- Lifetime `2^32` remains experimental; add it when both implementations support it end-to-end.

